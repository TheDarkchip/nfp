{"id":"nfp-0cc","title":"Minimize module exposures after refactor","description":"Review Nfp module imports and @[expose] usage to minimize public scope while keeping proofs intact; reduce public imports where not required.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-13T19:34:26.46573+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T20:34:08.660625+01:00","closed_at":"2026-01-13T20:34:08.660625+01:00","close_reason":"Closed","comments":[{"id":19,"issue_id":"nfp-0cc","author":"TheDarkchip","text":"Starting exposure/public-import minimization pass (focus: Model then Circuit).","created_at":"2026-01-13T18:38:59Z"},{"id":20,"issue_id":"nfp-0cc","author":"TheDarkchip","text":"Reduced exposure in Nfp/Model and Nfp/Circuit: switched to public section, then selectively re-exposed needed defs (linearRank, attention* core defs, Interface/TypedCircuit evals, InductionSpecApproxOn) and made SameInterface decidable instance private. Builds: lake build --wfail, lake build nfp --wfail.","created_at":"2026-01-13T18:49:21Z"},{"id":21,"issue_id":"nfp-0cc","author":"TheDarkchip","text":"Minimized exposures in Sound by replacing simp-on-def with public def-lemmas (using simp proofs) for ln/q/k/scores/headValue/headOutput and new dirHeadVecOfInputs_get. Added Batteries Vector lemmas import for ofFn/get, and only exposed buildInductionHeadCoreCacheWith to keep CoreSound proof definitional. Updated CoreSound/HeadOutput/LogitDiff to use *_def lemmas. lake build --wfail and lake build nfp --wfail pass.","created_at":"2026-01-13T19:20:09Z"},{"id":22,"issue_id":"nfp-0cc","author":"TheDarkchip","text":"Further reduced exposures: removed @[expose] from buildInductionHeadInputs, vRealOfInputs/valsRealOfInputs, sumFinCommonDen, dotFin; replaced rfl def-lemmas with simp proofs and updated CoreSound/HeadOutput/LogitDiff to use *_def lemmas. Remaining exposed def: buildInductionHeadCoreCacheWith (needed for definitional alignment in CoreSound). lake build --wfail and lake build nfp --wfail pass.","created_at":"2026-01-13T19:34:05Z"},{"id":23,"issue_id":"nfp-0cc","author":"TheDarkchip","text":"Removed final @[expose] in Sound by switching CoreSound/Basic to import all Nfp.Sound.Induction.Core.Basic (module-system guidance for unfolding private defs in lemma modules). buildInductionHeadCoreCacheWith is now unexposed; all Sound exposures eliminated. Builds: lake build --wfail, lake build nfp --wfail.","created_at":"2026-01-13T19:49:31Z"}]}
{"id":"nfp-0wx","title":"Speed up exact head-input recomputation","description":"Exact head-input recomputation in Lean is slow at nontrivial seq lengths, blocking large-scale induction-head audits. Optimize caching or algebraic reuse without weakening soundness.","acceptance_criteria":"certify_head_model inputs path is measurably faster; no soundness regressions; lake build --wfail passes.","status":"open","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-14T01:52:22.383819+01:00","created_by":"TheDarkchip","updated_at":"2026-01-14T01:52:22.383819+01:00","labels":["mode:in_progress"],"comments":[{"id":31,"issue_id":"nfp-0wx","author":"TheDarkchip","text":"Model-driven certify_nonvacuous timing out. Command: lake exe nfp induction certify_nonvacuous --model models/gpt2_small_seq32.nfpt --layer 9 --head 6 --max-eps 1 --preset fast --heartbeat-ms 2000 --timing 1. Head build finishes (~287s) then stalls at 'timing: head logit-diff lower bound start' for \u003e15 min (tool timeout).","created_at":"2026-01-14T07:53:26Z"},{"id":32,"issue_id":"nfp-0wx","author":"TheDarkchip","text":"Tried optimizations: logit-diff now uses shared cache (logitDiffCache) and cacheBoundTask for epsAt/valsLo; weightBoundAt now uses cacheBound2Task. IO path uses timePureWithHeartbeat and shared cache for unweighted/weighted. Model run (certify_nonvacuous, model gpt2_small_seq32, layer 9 head 6, max-eps 1, preset fast, heartbeat 2000, timing 1) still times out at 900s. Observed timings: head build cert ~285s, unweighted logit-diff ~214s; weighted logit-diff still running at \u003e319s when timeout hit. So weighted bound remains the bottleneck.","created_at":"2026-01-14T10:40:54Z"},{"id":33,"issue_id":"nfp-0wx","author":"TheDarkchip","text":"Need exact hotspot breakdown inside weighted logit-diff; add timing/profiling (valsLo, weightBoundAt, weighted gap sum, weighted min) gated by env var (e.g., NFP_TIMING_LOGITDIFF_PROFILE). Then re-run model-driven path to identify the bottleneck; consult Lean manual on arrays/tasks/thunks/runtime for perf guidance.","created_at":"2026-01-14T11:49:54Z"},{"id":34,"issue_id":"nfp-0wx","author":"TheDarkchip","text":"Ran model-driven path with NFP_TIMING_LOGITDIFF_PROFILE=1: lake exe nfp induction certify_nonvacuous --model models/gpt2_small_seq32.nfpt --layer 9 --head 6 --max-eps 1 --preset fast --heartbeat-ms 2000 --timing 1. Profile results before timeout: valsLo force ≈307,152,836 us (~307s); weightBoundAt force still running at \u003e592,110,488 us when the 1200s timeout hit. Weighted gap sum/min never reached. Hotspot is clearly weightBoundAt force; valsLo force is secondary.","created_at":"2026-01-14T12:18:19Z"}]}
{"id":"nfp-0wx.1","title":"State change: mode → in_progress","description":"Set mode to in_progress\n\nReason: Active optimization work on logit-diff weighted bound","status":"closed","priority":4,"issue_type":"event","created_at":"2026-01-14T11:42:02.855327+01:00","created_by":"TheDarkchip","updated_at":"2026-01-14T11:42:02.855327+01:00","closed_at":"2026-01-14T11:42:03.855327+01:00","dependencies":[{"issue_id":"nfp-0wx.1","depends_on_id":"nfp-0wx","type":"parent-child","created_at":"2026-01-14T11:42:02.856021+01:00","created_by":"TheDarkchip"}]}
{"id":"nfp-0wx.2","title":"Optimize weightBoundAt force hotspot","description":"Profiling with NFP_TIMING_LOGITDIFF_PROFILE shows weightBoundAt force dominating weighted logit-diff. Investigate caching/array layout, task scheduling, and redundant loops to reduce wall time.","acceptance_criteria":"weightBoundAt force no longer dominates weighted logit-diff on gpt2_small_seq32 l9 h6; certify_nonvacuous completes without timeout","status":"open","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-14T13:21:27.888545+01:00","created_by":"TheDarkchip","updated_at":"2026-01-14T13:21:27.888545+01:00","dependencies":[{"issue_id":"nfp-0wx.2","depends_on_id":"nfp-0wx","type":"parent-child","created_at":"2026-01-14T13:21:27.891048+01:00","created_by":"TheDarkchip"}],"comments":[{"id":35,"issue_id":"nfp-0wx.2","author":"TheDarkchip","text":"Added cached weightBoundAtBase (Bounds.cacheBound2) reused by epsAt/weightBoundAt; updated CoreSound proofs to rewrite via cacheBound2_apply. lake build --wfail passes.","created_at":"2026-01-14T12:41:18Z"},{"id":36,"issue_id":"nfp-0wx.2","author":"TheDarkchip","text":"Profile run after weightBoundAtBase caching (before qLo/kLo cache): head build ~349s, valsLo force ~322s, weightBoundAt force still running at ~500s when 1200s timeout hit; weighted gap/min not reached. Tried caching qLo/qHi/kLo/kHi via cacheBound2; head build induction cert no longer returned within 1200s (stuck at ~1170s), so reverted.","created_at":"2026-01-14T13:33:30Z"},{"id":37,"issue_id":"nfp-0wx.2","author":"TheDarkchip","text":"Ran certify_nonvacuous without logit-diff profiling after reverting qLo/kLo cache: head build cert ~347.6s, unweighted logit-diff ~280.6s; weighted logit-diff still running at ~544s when 1200s timeout hit (total \u003e1170s). Weighted stage remains bottleneck.","created_at":"2026-01-14T13:59:57Z"},{"id":38,"issue_id":"nfp-0wx.2","author":"TheDarkchip","text":"Added conditional in logitDiffLowerBoundWeightedAt to skip weightBoundAt when max(0,diff)=0; build passes. certify_nonvacuous timing: head build ~349s, unweighted ~250.5s; weighted still running at ~571s when 1200s timeout hit (no material improvement).","created_at":"2026-01-14T14:27:51Z"},{"id":39,"issue_id":"nfp-0wx.2","author":"TheDarkchip","text":"Added nonvacuous path precompute for weightBoundAt: spawn per-active-q tasks to force a single k per row (fills cache), overlapping with unweighted logit-diff; wait on precompute only when weighted needed; skip precompute when NFP_TIMING_LOGITDIFF_PROFILE is set; cancel task when weighted not needed. See Nfp/IO/InductionHead/Basic.lean.","created_at":"2026-01-14T15:24:56Z"},{"id":40,"issue_id":"nfp-0wx.2","author":"TheDarkchip","text":"Reworked nonvacuous path to spawn weighted logit-diff in background (skip when profiling), then await task if needed. Removed weightBoundAt precompute. Build nfp --wfail ok. Model run still timed out at 1200s: head build ~347.6s, unweighted ~283.1s; weighted stage still running \u003e564s at timeout. No material improvement yet.","created_at":"2026-01-14T16:14:44Z"},{"id":41,"issue_id":"nfp-0wx.2","author":"TheDarkchip","text":"Profile (NFP_TIMING_LOGITDIFF_PROFILE=1) after background weighted task change: valsLo force ≈285s; weightBoundAt force still running \u003e564s when 1200s timeout hit. Weighted gap sum/min not reached. Hotspot remains weightBoundAt force.","created_at":"2026-01-14T16:43:49Z"}]}
{"id":"nfp-1gd","title":"Align claims and soundness limitations with induction certification audit","description":"Update CLAIMS.md and SOUNDNESS_LIMITATIONS.md to reflect conditional head-level certification and updated CLI names.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-13T08:13:22.727618+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T08:13:41.983105+01:00","closed_at":"2026-01-13T08:13:41.983105+01:00","close_reason":"Closed"}
{"id":"nfp-1mx","title":"Investigate bounded-precision Rat rounding for induction cert speed","description":"Implement non-identity ratRoundDown/ratRoundUp (or local rounding) to control denominator growth while preserving bounds; measure impact on induction-head certification runtime.","status":"open","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-13T04:06:14.596939+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T04:06:14.596939+01:00","comments":[{"id":3,"issue_id":"nfp-1mx","author":"TheDarkchip","text":"Decision: keep full-precision Rat bounds for now; no bounded-precision rounding changes planned until further evidence.","created_at":"2026-01-13T06:51:29Z"}]}
{"id":"nfp-2cr","title":"Improve GPT-2 induction logit-diff bounds","description":" fails with logitDiffLB -2255815196141/250000250000 below min 0. Need improved value-range bounds or direction data to make logit-diff non-vacuous for canonical head.","status":"in_progress","priority":2,"issue_type":"task","assignee":"TheDarkchip","owner":"robin.gieseke@me.com","created_at":"2026-01-13T17:04:39.844935+01:00","created_by":"TheDarkchip","updated_at":"2026-01-14T02:05:13.230782+01:00","labels":["bug"],"dependencies":[{"issue_id":"nfp-2cr","depends_on_id":"nfp-axz","type":"relates-to","created_at":"2026-01-14T01:54:50.129974+01:00","created_by":"TheDarkchip"},{"issue_id":"nfp-2cr","depends_on_id":"nfp-866","type":"relates-to","created_at":"2026-01-14T01:55:06.203554+01:00","created_by":"TheDarkchip"}],"comments":[{"id":13,"issue_id":"nfp-2cr","author":"TheDarkchip","text":"Starting work on improving logit-diff bounds / direction handling for GPT-2 induction cert.","created_at":"2026-01-13T16:23:08Z"},{"id":14,"issue_id":"nfp-2cr","author":"TheDarkchip","text":"Work interrupted; investigation and proof changes need to be started anew (pending per-query value cert + logit-diff bounds).","created_at":"2026-01-13T16:54:34Z"},{"id":28,"issue_id":"nfp-2cr","author":"TheDarkchip","text":"Mechanistic framing: logit-diff bound remains vacuous for GPT-2 induction heads; likely needs tighter value-range bounds or direction data (OV path) and may interact with residual interval tightening (QK/OV composition).","created_at":"2026-01-14T00:52:32Z"},{"id":29,"issue_id":"nfp-2cr","author":"TheDarkchip","text":"Started fix: clamped per-key weight bounds by epsAt in induction cert builder, added verified logitDiffLowerBoundFromCertBest (max eps/weighted), and used it in head certify path. Targeted build: Build completed successfully (1900 jobs). succeeded.","created_at":"2026-01-14T01:44:29Z"},{"id":30,"issue_id":"nfp-2cr","author":"TheDarkchip","text":"Ran certify_nonvacuous on reports/gpt2_small_seq32_L9H6_t2_n5.head with --max-eps 1; logitDiffLB positive, bound=eps.","created_at":"2026-01-14T07:11:07Z"}]}
{"id":"nfp-35g","title":"Verify prev mapping corresponds to induction pattern","description":"Add a proof/verified derivation that prev indices align with the intended prefix-matching induction pattern for a given token sequence, or surface it as an explicit external assumption in certificates.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-13T08:09:29.898676+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T09:28:30.277766+01:00","closed_at":"2026-01-13T09:28:30.277766+01:00","close_reason":"Closed","comments":[{"id":4,"issue_id":"nfp-35g","author":"TheDarkchip","text":"Added prevOfTokens_spec_of_active lemma in Nfp/Model/InductionPrompt.lean; build passes.","created_at":"2026-01-13T07:25:58Z"},{"id":5,"issue_id":"nfp-35g","author":"TheDarkchip","text":"Added buildInductionHeadInputs_prev_spec_of_active in Nfp/IO/NfptPure.lean (using prevOfTokens_spec_of_active) so model-derived prev is the maximal prior match when period?=none; docs updated.","created_at":"2026-01-13T08:28:27Z"}]}
{"id":"nfp-3cw","title":"Centralize softmax weight invariants in induction stack","description":"## Context\n- The induction-head stack repeatedly re-proves softmax weight nonnegativity and sum-to-one.\n- Examples include: `Nfp/Sound/Induction/OneHot.lean`, `Nfp/Sound/Induction/CoreSound/Basic.lean`,\n  `Nfp/Sound/Bounds/Attention.lean`, and `Nfp/Sound/Induction/LogitDiff.lean`.\n- The existing `Nfp/Prob` + `Nfp/Mixer` formalization is currently unused downstream.\n\n## Problem\n- Proof obligations for `softmax_nonneg` and `softmax_sum_one` are duplicated across multiple modules.\n- This increases proof size, makes invariants harder to see, and raises maintenance cost.\n\n## Goal\n- Centralize the \"softmax yields a probability vector\" facts (nonneg + sum-to-one) so downstream\n  proofs can reuse them without repeating the same boilerplate.\n\n## Scope / Proposed Approach\n- Introduce a small wrapper structure (e.g., `SoftmaxWeights` or `ProbVecReal`) that packages:\n  - `weights : Fin seq -\u003e Fin seq -\u003e Real`\n  - `nonneg : forall q k, 0 \u003c= weights q k`\n  - `sum_one : forall q, (sum k, weights q k) = 1`\n- Add a lemma that constructs the wrapper from `Circuit.softmax` with a short docstring.\n- Update induction-head proofs to consume the wrapper instead of re-proving nonneg/sum-one locally.\n  Target files:\n  - `Nfp/Sound/Induction/OneHot.lean`\n  - `Nfp/Sound/Induction/CoreSound/Basic.lean`\n  - `Nfp/Sound/Bounds/Attention.lean`\n  - `Nfp/Sound/Induction/LogitDiff.lean`\n- Optionally evaluate whether `Nfp.Prob.ProbVec` can be generalized to Real; if the NNReal\n  mismatch is too invasive, keep the wrapper separate for now and document the tradeoff.\n\n## Acceptance Criteria\n- A new wrapper + constructor lemma exists with docstrings and no linter disables.\n- The target files no longer re-prove `Circuit.softmax_nonneg` and `Circuit.softmax_sum_one` locally;\n  they use the wrapper instead.\n- `lake build --wfail` succeeds.\n- No new axioms are introduced.\n\n## Risks / Notes\n- `ProbVec` is NNReal-based while softmax outputs Real; bridging may require a new structure or\n  a carefully scoped coercion. Avoid global simp rule growth.\n","acceptance_criteria":"- Wrapper + constructor lemma with docstrings added\n- Target induction/attention modules reuse wrapper (no local softmax nonneg/sum-one proofs)\n- `lake build --wfail` passes\n- No new axioms or linter disables","status":"closed","priority":2,"issue_type":"task","assignee":"TheDarkchip","owner":"robin.gieseke@me.com","created_at":"2026-01-14T01:21:43.85933+01:00","created_by":"TheDarkchip","updated_at":"2026-01-14T01:40:34.732005+01:00","closed_at":"2026-01-14T01:40:34.732005+01:00","close_reason":"completed","comments":[{"id":26,"issue_id":"nfp-3cw","author":"TheDarkchip","text":"Implemented Circuit.SoftmaxWeights wrapper + softmaxWeights constructor and softmaxWeights_weights lemma. Refactored OneHot, CoreSound/Basic, and Bounds/Attention to use wrapper for nonneg/sum_one (no local softmax_nonneg/sum_one). lake build --wfail succeeded.","created_at":"2026-01-14T00:39:46Z"}]}
{"id":"nfp-4y8","title":"Refactor parallel reductions to sequential core with equivalence lemmas","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T01:42:58.138743+01:00","updated_at":"2026-01-13T04:06:02.594691+01:00","closed_at":"2026-01-13T04:06:02.594691+01:00","close_reason":"Closed"}
{"id":"nfp-4z9","title":"Add trusted parser for NFP model slices","description":"Verified parser for WQ/WK/WV/WO, biases, LN params, and unembedding so QK/OV certificates rely on trusted extraction.","acceptance_criteria":"Parser returns proof-carrying slices; CLI uses it by default; lake build --wfail passes.","status":"open","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-14T01:51:29.014419+01:00","created_by":"TheDarkchip","updated_at":"2026-01-14T01:51:29.014419+01:00","dependencies":[{"issue_id":"nfp-4z9","depends_on_id":"nfp-mzt","type":"relates-to","created_at":"2026-01-14T01:54:59.550956+01:00","created_by":"TheDarkchip"},{"issue_id":"nfp-4z9","depends_on_id":"nfp-axz","type":"relates-to","created_at":"2026-01-14T01:55:02.927515+01:00","created_by":"TheDarkchip"}]}
{"id":"nfp-5gn","title":"Refactor module structure across repo to mathlib-style headers/imports","description":"Migrate all Lean files away from experimental module headers and public imports/sections; align import structure with mathlib-style source files.","status":"closed","priority":2,"issue_type":"task","assignee":"TheDarkchip","owner":"robin.gieseke@me.com","created_at":"2026-01-14T00:34:55.171544+01:00","created_by":"TheDarkchip","updated_at":"2026-01-14T00:59:02.052937+01:00","closed_at":"2026-01-14T00:59:02.052937+01:00","close_reason":"Closed","labels":["refactor"],"comments":[{"id":24,"issue_id":"nfp-5gn","author":"TheDarkchip","text":"Added mathlib module structure style guide to AGENTS.md; full repo refactor still pending.","created_at":"2026-01-13T23:41:15Z"},{"id":25,"issue_id":"nfp-5gn","author":"TheDarkchip","text":"Rescanned local mathlib: module headers in all .lean files; public import common but not universal; public section often with @[expose], plus public meta/noncomputable sections and rare import all. Updated AGENTS.md style guide accordingly.","created_at":"2026-01-13T23:45:41Z"}]}
{"id":"nfp-866","title":"Remove perfect-square head_dim restriction for attention scaling","description":"certify_head_model currently requires head_dim to be a perfect square to represent 1/sqrt(d) scaling exactly. This distorts QK margin bounds when head_dim is not square. Add a rational/interval bound for the scale (or exact sqrtLower/sqrtUpper) with proofs.","acceptance_criteria":"Supports non-square head_dim with bounded scale factor; softmax-margin proofs updated; lake build --wfail passes.","status":"open","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-14T01:51:49.18715+01:00","created_by":"TheDarkchip","updated_at":"2026-01-14T01:52:04.455932+01:00","dependencies":[{"issue_id":"nfp-866","depends_on_id":"nfp-2cr","type":"relates-to","created_at":"2026-01-14T01:55:06.203015+01:00","created_by":"TheDarkchip"}]}
{"id":"nfp-96w","title":"Tighten induction-head bounds for nonvacuous certification","description":"Upgrade per-query epsilon bounds to reduce vacuity in certify_head_model_nonvacuous.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-12T16:51:54.831367+01:00","created_by":"TheDarkchip","updated_at":"2026-01-12T17:12:14.022297+01:00","closed_at":"2026-01-12T17:12:14.022297+01:00","close_reason":"Implemented per-key epsilon bounds and proof updates; builds pass."}
{"id":"nfp-axz","title":"Tighten residual interval bounds using attention structure","description":"End-to-end logit-diff bounds are often vacuous because residual intervals ignore attention-score/softmax structure. Use certified attention weights or score-aware bounds to tighten residual propagation and preserve mechanistic QK/OV contributions.","acceptance_criteria":"Residual interval bounds incorporate attention/softmax structure or certified weights; GPT-2 end-to-end bounds improve; lake build --wfail passes.","status":"open","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-14T01:51:41.833297+01:00","created_by":"TheDarkchip","updated_at":"2026-01-14T01:51:41.833297+01:00","dependencies":[{"issue_id":"nfp-axz","depends_on_id":"nfp-mzt","type":"relates-to","created_at":"2026-01-14T01:54:44.801444+01:00","created_by":"TheDarkchip"},{"issue_id":"nfp-axz","depends_on_id":"nfp-2cr","type":"relates-to","created_at":"2026-01-14T01:54:50.129397+01:00","created_by":"TheDarkchip"},{"issue_id":"nfp-axz","depends_on_id":"nfp-suu","type":"relates-to","created_at":"2026-01-14T01:54:55.041696+01:00","created_by":"TheDarkchip"},{"issue_id":"nfp-axz","depends_on_id":"nfp-4z9","type":"relates-to","created_at":"2026-01-14T01:55:02.928061+01:00","created_by":"TheDarkchip"}]}
{"id":"nfp-dep","title":"Prove/log derivation for logit-diff direction vector","description":"Add a verified link from DirectionSpec (target/negative ids) to the actual unembedding direction used in certification, or explicitly verify the direction vector against model weights.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-13T08:09:25.330985+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T09:28:40.824036+01:00","closed_at":"2026-01-13T09:28:40.824036+01:00","close_reason":"Closed","comments":[{"id":6,"issue_id":"nfp-dep","author":"TheDarkchip","text":"Added buildInductionHeadInputs_def/buildInductionHeadInputs_direction_def in Nfp/IO/NfptPure.lean: directionSpec matches target/negative ids and direction is colTarget-colNegative from unembedding columns. Docs now note the remaining assumption that unembedding represents logits.","created_at":"2026-01-13T08:28:36Z"}]}
{"id":"nfp-e53","title":"Refactor and optimize module structure","description":"Create a dedicated branch and plan for Lean module/import refactor guided by the Lean manual.","notes":"Pilot module-system conversion for Core/Prob/Mixer/System: added module headers, public sections, public imports for used deps; enabled experimental.module in lakefile.toml and adjusted imports accordingly.","status":"closed","priority":2,"issue_type":"task","assignee":"TheDarkchip","owner":"robin.gieseke@me.com","created_at":"2026-01-13T17:57:19.507102+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T19:34:39.270845+01:00","closed_at":"2026-01-13T19:34:39.270845+01:00","close_reason":"Closed","comments":[{"id":15,"issue_id":"nfp-e53","author":"TheDarkchip","text":"Converted Nfp/Circuit and Nfp/Model trees to module system: added module headers, public imports, @[expose] public section on definition files, and public-import aggregators. lake build --wfail passes.","created_at":"2026-01-13T18:16:45Z"},{"id":16,"issue_id":"nfp-e53","author":"TheDarkchip","text":"Converted Nfp/Sound and Nfp/IO trees (and Nfp.lean) to module system with public imports; adjusted aggregator modules to avoid empty public sections. Fixed module-system visibility by switching HeadBounds/Basic and Bounds/Transformer/Embedding to public section and making internal spec lemmas private. lake build --wfail passes.","created_at":"2026-01-13T18:27:02Z"},{"id":17,"issue_id":"nfp-e53","author":"TheDarkchip","text":"Switched Nfp/IO modules to public section (no expose) and made IO spec/unfold lemmas private (HeadScore, NfptPure, InductionHead.Bytes). lake build nfp --wfail now passes.","created_at":"2026-01-13T18:32:50Z"},{"id":18,"issue_id":"nfp-e53","author":"TheDarkchip","text":"Converted top-level aggregator modules (Nfp.Circuit/IO/Model/Sound) to module headers with public imports; lake build --wfail rechecked.","created_at":"2026-01-13T18:34:04Z"}]}
{"id":"nfp-ete","title":"Evaluate nonvacuous induction certification on real models","description":"Run certify_head_model_nonvacuous on GPT-2/GPT2-small binaries; if still vacuous, explore tighter value-range bounds (per-query or mask-aware).","notes":"Investigating nonvacuous induction head certification","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-12T17:11:56.642685+01:00","created_by":"TheDarkchip","updated_at":"2026-01-12T23:28:32.804466+01:00","closed_at":"2026-01-12T23:28:32.804466+01:00","close_reason":"Closed","comments":[{"id":2,"issue_id":"nfp-ete","author":"TheDarkchip","text":"Fixed f64-\u003eRat conversion: use signed exponent in NfptPure.ratOfFloatBits. Lean model reads now match head inputs; certify_head_model_nonvacuous succeeds (build ~370s, logit diff fast).","created_at":"2026-01-12T22:28:26Z"}]}
{"id":"nfp-g0j","title":"Refactor HeadBounds reduction helpers","description":"Deduplicate chunked reduction task helpers in Nfp/Sound/Induction/HeadBounds.lean to reduce proof churn while preserving behavior.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-12T16:21:11.583135+01:00","created_by":"TheDarkchip","updated_at":"2026-01-12T16:22:20.621327+01:00","closed_at":"2026-01-12T16:22:20.621327+01:00","close_reason":"Completed"}
{"id":"nfp-g78","title":"Refactor CoreSound lemmas for stability","description":"Refactor Nfp/Sound/Induction/CoreSound.lean to reduce proof churn and improve maintainability; keep proofs explicit and stable.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-12T16:12:25.347409+01:00","created_by":"TheDarkchip","updated_at":"2026-01-12T16:16:04.322186+01:00","closed_at":"2026-01-12T16:16:04.322186+01:00","close_reason":"Completed","labels":["in_progress"]}
{"id":"nfp-giz","title":"Remove remaining @[expose] and add def lemmas for module system","description":"Drop remaining expose attributes, add explicit def lemmas, and update simp uses to match mathlib-style module boundaries.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-13T21:36:36.153438+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T22:23:45.005299+01:00","closed_at":"2026-01-13T22:23:45.005299+01:00","close_reason":"Closed","labels":["refactor"]}
{"id":"nfp-mzt","title":"Bridge head-level induction certificates to block/model logits","description":"Add formal bridge theorems from head-level certificates (attention + value + logit-diff bounds) to block-level or end-to-end model logit bounds.","status":"open","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-13T08:09:33.475601+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T08:09:33.475601+01:00","dependencies":[{"issue_id":"nfp-mzt","depends_on_id":"nfp-axz","type":"relates-to","created_at":"2026-01-14T01:54:44.801985+01:00","created_by":"TheDarkchip"},{"issue_id":"nfp-mzt","depends_on_id":"nfp-4z9","type":"relates-to","created_at":"2026-01-14T01:54:59.551515+01:00","created_by":"TheDarkchip"}],"comments":[{"id":7,"issue_id":"nfp-mzt","author":"TheDarkchip","text":"Added bridge lemmas in LogitDiff.lean: headLogitDiff_eq_direction_dot_headOutput and logitDiffLowerBound_with_residual (compose head logit-diff bound with residual interval bounds). Updated CLAIMS.md and docs/induction_cert_audit.md to reflect the partial bridge; full end-to-end model semantics still open.","created_at":"2026-01-13T11:18:45Z"},{"id":8,"issue_id":"nfp-mzt","author":"TheDarkchip","text":"Added gpt2ResidualIntervalBoundsActive_sound in Sound/Bounds/Transformer.lean to package GPT-2 residual bounds into a ResidualIntervalCert with ResidualIntervalBounds + output_mem for transformerStackFinalReal (requires hne/heps/hsqrt). Updated CLAIMS.md and docs/induction_cert_audit.md accordingly. Next gap: connect head-level logit-diff contribution through the stack (residual is not just additive after LN/MLP).","created_at":"2026-01-13T11:31:05Z"},{"id":9,"issue_id":"nfp-mzt","author":"TheDarkchip","text":"Added logitDiffLowerBound_with_output_intervals in Sound/Induction/LogitDiff.lean: combines head logit-diff LB with head-output intervals and downstream output intervals via interval subtraction (residual = output - headOutput). Updated CLAIMS.md, docs/induction_cert_audit.md, SOUNDNESS_LIMITATIONS.md to reflect this partial bridge.","created_at":"2026-01-13T11:42:26Z"},{"id":10,"issue_id":"nfp-mzt","author":"TheDarkchip","text":"Added EndToEnd.lean with logitDiffLowerBound_end_to_end_gpt2: instantiates logitDiffLowerBound_with_output_intervals using HeadOutputIntervalSound and gpt2ResidualIntervalBoundsActive_sound to bound direction·transformerStackFinalReal. Updated Induction aggregator and MODULE_MAP. Build clean.","created_at":"2026-01-13T11:49:54Z"},{"id":11,"issue_id":"nfp-mzt","author":"TheDarkchip","text":"Wired nfp induction certify_end_to_end_model to optionally derive head-output interval bounds when --layer/--head are provided (with optional --period). CLI now computes interval-composed bound via head output intervals and residual intervals, reports intervalLB/effectiveLB, and keeps base downstream bound as fallback.","created_at":"2026-01-13T12:21:53Z"},{"id":27,"issue_id":"nfp-mzt","author":"TheDarkchip","text":"SOUNDNESS_LIMITATIONS note: end-to-end bridge still ignores LN/MLP propagation of head outputs and assumes unembedding columns define logits. Consider extending the bridge to model block semantics (residual/LN/MLP) and making the logit map explicit in the proof chain.","created_at":"2026-01-14T00:52:28Z"}]}
{"id":"nfp-osv","title":"Expose split-budget knobs for induction head certification","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T00:52:32.742247+01:00","updated_at":"2026-01-13T01:11:40.876901+01:00","closed_at":"2026-01-13T01:11:40.876901+01:00","close_reason":"Closed"}
{"id":"nfp-pgc","title":"Merge refactor/module-structure-nfp-e53 into audit-induction-cert","notes":"Merged refactor/module-structure-nfp-e53 into audit-induction-cert.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T01:47:18.190665+01:00","updated_at":"2026-01-14T01:49:02.950839+01:00","closed_at":"2026-01-14T01:49:02.950845+01:00"}
{"id":"nfp-snh","title":"Refactor MatrixNorm interval bounds proofs","description":"Refactor Nfp/Sound/Bounds/MatrixNorm/Interval.lean to reduce proof churn and simplify interval bound lemmas.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-12T15:54:50.752468+01:00","created_by":"TheDarkchip","updated_at":"2026-01-12T16:01:12.070535+01:00","closed_at":"2026-01-12T16:01:12.070535+01:00","close_reason":"Closed","comments":[{"id":1,"issue_id":"nfp-snh","author":"TheDarkchip","text":"Refactored foldl_pair helper for pair foldl projections in MatrixNorm interval bounds; adjusted proofs to use Prod.fst/Prod.snd. Fixed CoreSound cdot lint warnings encountered during build.","created_at":"2026-01-12T15:01:08Z"}]}
{"id":"nfp-suu","title":"Include attention output bias in head certification","description":"Current head certification ignores the shared attention output bias; this is an extra residual-stream write alongside OV and can shift logit-diff bounds. Add it to head output/value bounds so QK/OV path decomposition matches model semantics.","acceptance_criteria":"Head-output/value bounds account for attn output bias in certify_head/certify_head_model; docs updated; lake build --wfail passes.","status":"open","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-14T01:51:35.915011+01:00","created_by":"TheDarkchip","updated_at":"2026-01-14T01:51:35.915011+01:00","dependencies":[{"issue_id":"nfp-suu","depends_on_id":"nfp-axz","type":"relates-to","created_at":"2026-01-14T01:54:55.041176+01:00","created_by":"TheDarkchip"}]}
{"id":"nfp-x8g","title":"Streamline CLI options and induction certification UX","description":"Reduce option surface area, add presets/shortcuts, and improve defaults for induction certification commands without losing advanced configurability.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-13T07:53:31.417957+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T08:00:52.123717+01:00","closed_at":"2026-01-13T08:00:52.123717+01:00","close_reason":"Closed"}
{"id":"nfp-xh8","title":"Fix stack overflow when certifying GPT-2 induction certs","description":"Stack overflow when running induction certification on seq=256 GPT-2 certs. Repro: generate softmax/value certs via scripts/build_gpt2_induction_cert_from_binary.py on /Users/robin/Uni/iml/gpt2_rigorous.nfpt (layer 5 head 1, target 2835, negative 4236). Then run lake exe nfp induction advanced certify with those files; crash with stack overflow. End-to-end model path also crashes even with dummy residual interval. Suspect checkSoftmaxMarginCert / finset recursion; consider loop/array-based checks.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-13T16:19:57.127206+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T16:59:56.811923+01:00","closed_at":"2026-01-13T16:59:56.811923+01:00","close_reason":"Stack overflow resolved by array-backed parse state; GPT-2 cert check runs.","labels":["bug"],"comments":[{"id":12,"issue_id":"nfp-xh8","author":"TheDarkchip","text":"Switched SoftmaxMargin ParseState matrices from nested function updates to Array-of-Array storage and use Array.all in finalize; lookup now uses array indexing. Stack overflow gone: ok: softmax-margin certificate accepted (seq=256, active=2) succeeds. With values: fails on negative logitDiffLB (no crash).","created_at":"2026-01-13T15:59:38Z"}]}
{"id":"nfp-z1j","title":"Audit induction-head certification soundness claim","description":"Review proof chain for induction-head certification and document scope/limitations with mechinterp framing.","status":"closed","priority":2,"issue_type":"task","owner":"robin.gieseke@me.com","created_at":"2026-01-13T08:09:10.323741+01:00","created_by":"TheDarkchip","updated_at":"2026-01-13T08:10:29.361118+01:00","closed_at":"2026-01-13T08:10:29.361118+01:00","close_reason":"Closed"}
